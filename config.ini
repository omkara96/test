INSERT INTO CIM_LC_INT.PRC_ULT_DCTR_WKPLC (
    LYT_CLS,
    RCR_ID,
    PRS_CD,
    PRS_CD_RSV,
    MDF_CLS,
    WKP_FCL_RCR_ID,
    WKP_FCL_CD,
    WKP_FCL_CD_RSV,
    RSV_RTR_MV_CLS,
    MNT_DT,
    RSV_TRN_DT_VN,
    PST_CD,
    UNV_PST_CD,
    DPR_CD,
    DPR_KNJ,
    DPR_KN,
    N_DRC_ML_FLG,
    SRC_LOAD_BATCH_ID,
    CRTN_ID,
    SYS_CRTN_DT_TM,
    LAST_UPDT_ID,
    SYS_LAST_UPDT_DT_TM,
    MDM_DMN_GEO_CD,
    INFO_SRC_CD,
    INFO_SRC_OBJ_NM,
    LOAD_KEY,
    OPERATION_FLAG,
    DA_SOURCE_CODE,
    DA_AREA_CODE
)
SELECT
    C.LYT_CLS,
    C.RCR_ID,
    P.PRS_CD,
    C.PRS_CD_RSV,
    P.MDF_CLS,
    C.WKP_FCL_RCR_ID,
    C.WKP_FCL_CD,
    C.WKP_FCL_CD_RSV,
    '1',
    P.MNT_DT AS MNT_DT,
    P.RSV_TRN_DT_VN,
    P.PST_CD,
    P.UNV_PST_CD,
    P.DPR_CD,
    P.DPR_KNJ,
    P.DPR_KN,
    P.N_DRC_ML_FLG,
    P.SRC_LOAD_BATCH_ID,
    P.CRTN_ID,
    P.SYS_CRTN_DT_TM,
    P.LAST_UPDT_ID,
    P.SYS_LAST_UPDT_DT_TM,
    P.MDM_DMN_GEO_CD,
    P.INFO_SRC_CD,
    P.INFO_SRC_OBJ_NM,
    P.LOAD_KEY,
    'D',
    P.DA_SOURCE_CODE,
    P.DA_AREA_CODE
FROM
    CIM_LC_INT.PRC_ULT_DCTR P
    JOIN CIM_LC_PRST.PRST_ULT_DCTR_WKPLC_C C
        ON C.PRS_CD = P.PRS_CD
        AND C.DA_AREA_CODE = P.DA_AREA_CODE
        AND C.DA_SOURCE_CODE = P.DA_SOURCE_CODE
WHERE
    P.MDF_CLS = 'C'
    AND P.DA_AREA_CODE = 'pi_str_areaCode'
    AND P.DA_SOURCE_CODE = 'pi_str_sourceCode'
    AND NOT EXISTS (
        SELECT 1
        FROM CIM_LC_INT.PRC_ULT_DCTR_WKPLC T
        WHERE T.PRS_CD = P.PRS_CD
          AND T.WKP_FCL_CD = C.WKP_FCL_CD
          AND T.DA_AREA_CODE = P.DA_AREA_CODE
          AND T.DA_SOURCE_CODE = P.DA_SOURCE_CODE
          AND NVL(T.RSV_RTR_MV_CLS, 'X') = '1'
    );
